<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="../favicon.ico">

  <title>Card Game - Stanford Research</title>

  <!-- Bootstrap core CSS -->
  <link href="/lib/css/bootstrap.min.css" rel="stylesheet">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body role="document">

  <div class="container theme-showcase" role="main">

    </br>
    <div class="progress">
      <div class="progress-bar" role="progressbar" aria-valuenow="5" aria-valuemin="0" aria-valuemax="100" style="width: 5%;"><span class="sr-only">5% Complete</span></div>
    </div>

    <div class="page-header">
      <h1>Instructions</h1>
    </div>

    <div class="well" style="width:800px; margin: 0 auto">

      <h2>
        <center>The Cards Game!</center>
      </h2>

      <center>
        <h4> In this experiment, you will play a fun collaborative card game with another player!</h4>
      </center>
      <center><img src="images/exampleSetup.png" alt="exampleSetup.png" style="width:80%"></center>

      <h3> Goal </h3>
      <p>
        The goal of the game is to <b>work with your partner</b> to obtain a <b>6-card straight flush</b> - i.e. 6 consecutive
        cards of the same suit. The <b>cards may wrap</b> around the ‘end’ of the deck, e.g. Q-K-A-2-3-4. Note that for a
        winning hand, a player’s own cards need not be in consecutive order. For example, one player with 5-8-10 of clubs
        and the other with 6-7-9 of clubs is a winning hand, because collaboratively they have 5-6-7-8-9-10.
      </p>

      <h3> Setup </h3>
      <p>
        Each player holds 3 cards at a time in their hand, with your hand placed on the bottom of the screen. Four cards are placed
        in the middle of the table. On the left is a deck displaying the number of cards remaining. The game is open-hand,
        meaning both players can see all cards at all times. A button to end the turn is placed at the bottom right, and
        a chat box is provided below.
      </p>

      <h3> Rules </h3>
      <p>
        The game is turn-based. To work towards your goal, you <b>must swap</b> out at least one of your cards with a card
        on the table
        <b>on your turn</b>. To swap two cards, simply drag and drop a card on top of another. After performing at least
        one swap, you may proceed to the next turn.
      </p>
      <center><img src="images/turnExample.gif" alt="turnExample.gif" style="width:80%"></center>
      <br>
      <p>
        At the end of the turn, the cards on the table are <b>reshuffled</b> into a random place in the deck <b>or discarded at random</b>,
        which you’ll be able to see written above the deck (e.g. “0 cards reshuffled”). Then, four new cards will be drawn
        from the deck to begin your partner’s turn. Watch out! If no more cards remain in the deck, the game is lost. Achieving
        the 6-card straight flush means you win!
      </p>
      <p>
        If the goal you originally decided on isn't working out, it might be useful to <b>switch goals</b>.
      </p>
      <p>
        Remember to <b>use the chat box</b> to work with your partner. In this game, communication and teamwork is the key
        to success. You can send messages to your partner at any time and as often as you like. Finally, please remember
        to be nice and courteous to your fellow players.
      </p>

      <h3> Note </h3>
      <p>
        Please DO NOT refresh the page at any point once you start the game (including the waiting page). If you refresh, you will
        not be able to rejoin the current game and might have issues properly submitting your work. Thank you!
      </p>

      <p>
        You’re all set. Complete the short comprehension quiz below to continue to the game. Good luck and have fun!
      </p>


    </div>
    <div class="page-header">
      <h3>Comprehension Quiz</h3>
    </div>

    <div class="well" style="width:800px; margin: 0 auto">

      </br>
      The goal of the game is to obtain a 6-card straight flush.
      </br>
      <input type="radio" name="goal" value="yes"> True
      </br>
      <input type="radio" name="goal" value="no"> False
      </br>


      </br>
      Players may swap with cards on the table only on their turn.
      </br>
      <input type="radio" name="turnOnly" value="yes"> True
      </br>
      <input type="radio" name="turnOnly" value="no"> False
      </br>


      </br>
      Players can directly swap cards with their partner.
      </br>
      <input type="radio" name="canTrade" value="no"> True
      </br>
      <input type="radio" name="canTrade" value="yes"> False
      </br>

      </br>
      In a winning hand, cards may wrap around the end of the deck (e.g. Q-K-A-2-3-4).
      </br>
      <input type="radio" name="wrap" value="yes"> True
      </br>
      <input type="radio" name="wrap" value="no"> False
      </br>

      </br>
      At the end of the turn, reshuffled cards are always placed back at the bottom of the deck.
      </br>
      <input type="radio" name="location" value="no"> True
      </br>
      <input type="radio" name="location" value="yes"> False
      </br>

      </br>
      It is possible that all the cards on the table (not in the players' hands) could get reshuffled.
      </br>
      <input type="radio" name="probability" value="yes"> True
      </br>
      <input type="radio" name="probability" value="false"> False
      </br>


      </br>
      <input id="quiz_submit" type="submit" value="Submit">
      </br>
      </br>
      <div class="error" style="display:none"> Oops! Looks like you made a mistake. You have one more try. </div>
    </div>
    <!-- /container -->
  </div>
  <script type="text/javascript">
    $('html,body').scrollTop(0);
    var urlParams;
    var match,
      pl = /\+/g,  // Regex for replacing addition symbol with a space
      search = /([^&=]+)=?([^&]*)/g,
      decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
      query = location.search.substring(1);

    urlParams = {};
    while (match = search.exec(query))
      urlParams[decode(match[1])] = decode(match[2]);

    console.log(urlParams)

    var counter = 0;
    document.getElementById("quiz_submit").onclick = function () {
      var ans1 = $('input[name="goal"]:checked').val();
      var ans2 = $('input[name="turnOnly"]:checked').val();
      var ans3 = $('input[name="canTrade"]:checked').val();
      var ans4 = $('input[name="wrap"]:checked').val();
      var ans5 = $('input[name="probability"]:checked').val();
      var ans6 = $('input[name="location"]:checked').val();

      if (ans1 == "yes" && ans2 == "yes" && ans3 == "yes" &&
        ans4 == "yes" && ans5 == "yes" && ans6 == "yes") {
        var workerId = urlParams.workerId;
        var assignmentId = urlParams.assignmentId;
        var hitId = urlParams.hitId;
        var turkSubmitTo = urlParams.turkSubmitTo;
        location.replace("./pass.html?workerId=" + workerId
          + "&assignmentId=" + assignmentId
          + "&hitId=" + hitId + "&turkSubmitTo=" + turkSubmitTo);
      } else if (counter == 3) {
        location.replace("./fail.html");
      } else {
        $('.error').show()
        counter += 1;
      }
    };
  </script>

  <script src="./validate-form.js"></script>

  <!-- Bootstrap core JavaScript
    ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="/lib/js/bootstrap.min.js"></script>
</body>

</html>